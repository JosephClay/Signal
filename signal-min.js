// Signal.js 0.0.1
// Signal may be freely distributed under the MIT license.
var Signal=function(){var a=/\w([^:\.])*/g,b=function(){this.reset()};return b.construct=function(){return new b},b.prototype={reset:function(){return this._active={},this._inactive={},this._subid=0,this._subscriptions={},this},subscribe:function(a,b){var c=this._uniqueSubId(),d=this._subscriptions[a]||(this._subscriptions[a]=[]);return b.__subid__=c,d.push(b),c},unsubscribe:function(a,b){var c=this._subscriptions[a];if(c){for(var d=0,e=c.length;e>d;d++)if(c[d].__subid__===b)return c.splice(d,1),!0;return!1}},dispatch:function(){for(var a=_.toArray(arguments),b=a.splice(0,1)[0],c=this._subscriptions[b],d=0,e=c.length;e>d;d++)c[d].apply(null,a)},create:function(a,b){var c,d;for(c in b)d=this._getEventConfig(a+":"+c),this._createEventLocation(d,this._active),this._active[d.handle][d.evt][d.namespace]=b[c];return this},disable:function(a){return this._inactive[a]=this._inactive[a]||{},this._inactive[a]=_.extend({},this._active[a]),delete this._active[a],this},enable:function(a){return this._active[a]=this._active[a]||{},this._active[a]=_.extend({},this._inactive[a]),delete this._inactive[a],this},on:function(a,b){var c=this._getEventConfig(a),d=this._createEventLocation(c);return d.push(b),this},off:function(a){var b=this._getEventConfig(a);return b.hasNamespace?this._active[b.handle][b.evt][b.namespace]=[]:this._active[b.handle][b.evt]={"":[]},this},once:function(a,b){return this.on(a,_.once(b))},trigger:function(){var a=_.toArray(arguments),b=a.splice(0,1)[0],c=this._getEventConfig(b),d=this._getEventLocation(c);if(!d)return this;if(c.hasNamespace)this._callEventArray(d,a);else{var f,e=this._active[c.handle][c.evt];for(f in e)this._callEventArray(e[f],a)}return this},listenTo:function(a,b,c){return this._listenCheck(a),a.on(b,c),this},stopListening:function(a,b){return this._listenCheck(a),a.off(b),this},_listenCheck:function(a){if(!a||!a.on||!a.off)throw new Error("Object cannot be listened to: "+a)},_uniqueSubId:function(){return"s"+this._subid++},_getEvent:function(a){return this._createEventLocation(this._getEventConfig(a))},_callEventArray:function(a,b){b=b||[];for(var f,c=0,d=a.length;d>c;c++)if(f=a[c],f&&f.apply(null,b)===!1)return},_getEventConfig:function(b){var c=-1!==b.indexOf(":")?!0:!1,d=-1!==b.indexOf(".")?!0:!1,e=b.match(a),f={};return f=c&&d?{handle:e[0],evt:e[1],namespace:e[2]}:c&&!d?{handle:e[0],evt:e[1],namespace:""}:d&&!c?{handle:"",evt:e[0],namespace:e[1]}:{handle:"",evt:e[0],namespace:""},f.hasHandle=c,f.hasNamespace=d,f},_getEventLocation:function(a,b){b=b||this._active;var c=b[a.handle];if(c){var d=c[a.evt];if(d){if(!a.hasNamespace)return d;var e=d[a.namespace];if(e)return e}}},_createEventLocation:function(a,b){b=b||this._active;var c=b[a.handle]||(b[a.handle]={}),d=c[a.evt]||(c[a.evt]={}),e=d[a.namespace]||(d[a.namespace]=[]);return e},toString:function(){return"[ Signal ]"}},new b}();